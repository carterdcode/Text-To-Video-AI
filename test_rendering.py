from openai import OpenAI
import os
import edge_tts
import json
import asyncio
import whisper_timestamped as whisper
from utility.audio.audio_generator import generate_audio
from utility.captions.timed_captions_generator import generate_timed_captions
from utility.video.background_video_generator import generate_timed_image_urls
from utility.render.render_engine import get_output_media
from utility.video.video_search_query_generator import getImagePromptsTimed, merge_empty_intervals
import argparse
import utility.script.script_generator as script_generator


if __name__ == "__main__":
    timed_generated_image_urls = [[['0', '6'], 'https://storage.googleapis.com/a1aa/image/2ae03e00-799f-4521-9abf-db4750264b82.jpeg'], [['6', '10'], 'https://storage.googleapis.com/a1aa/image/95517bba-1b36-4afa-9ce1-6c232f5639fd.jpeg'], [['10', '14'], 'https://storage.googleapis.com/a1aa/image/379ea23f-d3d6-4895-afd5-c32e5d9ee20b.jpeg'], [['14', '18'], 'https://storage.googleapis.com/a1aa/image/5f61875a-6193-4c13-8f65-f581685fac11.jpeg'], [['18', '22'], 'https://storage.googleapis.com/a1aa/image/51cc8cab-580b-4374-8851-d0246c5dc7fa.jpeg'], [['22', '26'], 'https://storage.googleapis.com/a1aa/image/f4d3c8ba-4c2f-4fa8-bae3-b304258b7dd2.jpeg'], [['26', '30'], 'https://storage.googleapis.com/a1aa/image/838f8293-c1a4-4c26-8265-0ddaf9f3194e.jpeg'], [['30', '34'], 'https://storage.googleapis.com/a1aa/image/4f1b5e7a-6a7d-4b36-80b9-6300d1449fc9.jpeg'], [['34', '38'], 'https://storage.googleapis.com/a1aa/image/3de08356-a3d6-487b-b9fb-50dcb11f569d.jpeg'], [['38', '42'], 'https://storage.googleapis.com/a1aa/image/f765ff18-9193-4075-a77e-1d03432933dd.jpeg'], [['42', '46'], 'https://storage.googleapis.com/a1aa/image/077b9f5f-101a-4288-af27-4d186494c83b.jpeg'], [['46', '50'], 'https://storage.googleapis.com/a1aa/image/55cb1ef7-13dd-4230-9f2f-64fe1288ced2.jpeg']]
    timed_captions = [((0, 0.68), 'Explore the')((0.68, 1.12), 'breathtaking')((1.12, 1.84), 'Thai islands')((1.84, 2.58), 'where paradise')((2.58, 2.96), 'awaits.')((2.96, 4.6), 'Start with')((4.6, 6.04), 'KOH-5-5, famous')((6.04, 6.74), 'for its crystal')((6.74, 7.3), 'clear waters')((7.3, 7.92), 'and vibrant')((7.92, 8.42), 'nightlife.')((8.42, 9.78), 'Imagine')((9.78, 10.64), 'snorkeling with')((10.64, 11.32), 'colorful marine')((11.32, 12.18), 'life at Mayabe.')((12.18, 13.9), 'Then hop')((13.9, 14.3), 'over to')((14.3, 15.2), 'KOH-Semui,')((15.2, 15.52), 'where')((15.52, 16.08), 'palm-frenched')((16.08, 16.76), 'beaches and')((16.76, 17.56), 'luxury resorts')((17.56, 17.86), 'blend')((17.86, 18.52), 'seamlessly with')((18.52, 19.36), 'local culture.')((19.36, 20.78), "Don't miss")((20.78, 21.2), 'the stunning')((21.2, 21.76), 'Big Buddha.')((21.76, 23.42), 'For a quieter')((23.42, 24.24), 'escape, head')((24.24, 25.22), 'to KOH-Lanta,')((25.22, 26.02), 'perfect for')((26.02, 26.72), 'relaxing beach')((26.72, 27.22), 'days and')((27.22, 27.6), 'incredible')((27.6, 28.18), 'sunsets.')((28.18, 29.68), 'Looking for')((29.68, 30.06), 'adventure.')((30.06, 31.98), 'KOH-DOW is')((31.98, 32.36), 'your spot')((32.36, 32.9), 'for diving')((32.9, 33.48), 'with some')((33.48, 33.94), 'of the best')((33.94, 34.5), 'spots in')((34.5, 35.34), 'Southeast Asia.')((35.34, 36.66), 'Lastly,')((36.66, 37.48), 'discover the')((37.48, 37.88), 'untouched')((37.88, 38.34), 'beauty of')((38.34, 39.38), 'KOH-I-Noi,')((39.38, 39.78), 'where you')((39.78, 40.18), 'can soak')((40.18, 40.74), 'in tranquil')((40.74, 41.28), 'views and')((41.28, 41.64), 'immerse')((41.64, 42.22), 'yourself in')((42.22, 42.58), 'the local')((42.58, 43.22), 'fishing village')((43.22, 43.58), 'life.')((43.58, 45.02), 'Each island')((45.02, 45.5), 'offers a')((45.5, 45.66), 'unique')((45.66, 46.24), 'experience,')((46.24, 46.74), 'what are')((46.74, 47.1), 'you waiting')((47.1, 47.42), 'for?')((47.42, 48.76), 'Pack your')((48.76, 49.24), 'bags and')((49.24, 49.58), 'let the')((49.58, 49.88), 'adventure')((49.88, 50.28), 'begin.')]
    #timed_generated_image_urls = [[['5.36', '6.9'], 'https://storage.googleapis.com/a1aa/image/9edde4c8-48dc-430e-b87a-b9a9952509a5.jpeg'], [['11.96', '13.3'], 'https://storage.googleapis.com/a1aa/image/699abf4c-08ec-4ec3-afcb-9d9144f3a5ff.jpeg'], [['17.22', '19.1'], 'https://storage.googleapis.com/a1aa/image/f3580ab5-e75b-483b-ac61-9cd397c6a6e5.jpeg'], [['23.58', '24.76'], 'https://storage.googleapis.com/a1aa/image/9865fbd4-7b5f-4851-ac74-b2deb706060d.jpeg'], [['24.76', '25.6'], 'https://storage.googleapis.com/a1aa/image/a73b1b63-6e5f-4233-a61a-05b80881a93e.jpeg'], [['3.2', '3.92'], 'https://storage.googleapis.com/a1aa/image/d34af75a-7ae6-46f3-a8a8-4dc4e893b39e.jpeg'], [['29.14', '30.4'], 'https://storage.googleapis.com/a1aa/image/fd52f979-51bd-401b-868f-30068d5e0497.jpeg'], [['36.26', '37.3'], 'https://storage.googleapis.com/a1aa/image/10f6f818-0773-421b-b5f2-5d6c2a87b55f.jpeg'], [['39.06', '39.86'], 'https://storage.googleapis.com/a1aa/image/fc0e3c93-52c9-45a9-8eed-da2f5466a2a6.jpeg'], [['34.28', '35.72'], 'https://storage.googleapis.com/a1aa/image/33ffdd00-4829-401b-8e44-1850efae443a.jpeg'], [['12.3', '13.3'], 'https://storage.googleapis.com/a1aa/image/2373ba08-3ba7-4f20-a5b4-94302e4889c1.jpeg'], [['45.76', '46.42'], 'https://storage.googleapis.com/a1aa/image/75e406c9-53f4-4873-9ecf-343faf93524c.jpeg']]
    #timed_captions = [((0, 0.82), 'Spain a')((0.82, 1.52), 'land of vibrant')((1.52, 2.2), 'culture and')((2.2, 2.6), 'breathtaking')((2.6, 3.2), 'landscapes')((3.2, 3.92), 'awaits you')((3.92, 5.36), 'Start in')((5.36, 5.88), 'Barcelona')((5.88, 6.9), 'where Gordiasa')((6.9, 7.58), 'grata familiar')((7.58, 8.38), 'and the lively')((8.38, 9.0), 'La Rambla')((9.0, 9.46), 'will ignite')((9.46, 10.0), 'your senses')((10.0, 11.52), "Don't miss")((11.52, 11.96), 'the stunning')((11.96, 12.3), 'beaches of')((12.3, 13.3), 'Costa Brava')((13.3, 13.84), 'perfect for')((13.84, 14.54), 'sunsake')((14.54, 15.02), 'relaxation')((15.02, 16.68), 'Venture to')((16.68, 17.22), 'Seville where')((17.22, 18.06), 'Flamenco')((18.06, 18.46), 'dancing and')((18.46, 19.1), 'the majestic')((19.1, 19.1), 'Alcata')((19.1, 20.26), 'transport you')((20.26, 20.94), 'to another')((20.94, 21.26), 'era Explore')((21.26, 23.22), 'the historic')((23.22, 23.58), 'streets of')((23.58, 24.24), 'Granada and')((24.24, 24.76), 'Marvel at')((24.76, 25.6), 'the Alhambra')((25.6, 25.6), 'a UNESCO')((25.6, 26.58), 'World Heritage')((26.58, 26.98), 'site For')((26.98, 28.62), 'a taste of')((28.62, 29.14), 'the unique')((29.14, 29.62), 'bass culture')((29.62, 30.4), 'head to Sandsa')((30.4, 31.38), 'Bastion known')((31.38, 31.74), 'for its')((31.74, 32.1), 'world-class')((32.1, 32.62), 'cuisine and')((32.62, 33.24), 'picturesque')((33.24, 33.86), 'coastline')((33.86, 34.28), 'Finally')((34.28, 35.72), 'immerse')((35.72, 36.26), 'yourself in')((36.26, 36.78), 'the art and')((36.78, 37.3), 'history of')((37.3, 37.78), 'Madrid home')((37.78, 38.48), 'to the famous')((38.48, 39.06), 'Prado Museum')((39.06, 39.86), 'Spain is')((39.86, 41.22), 'not just')((41.22, 41.9), 'a destination')((41.9, 42.52), "it's an")((42.52, 42.98), 'adventure')((42.98, 43.4), 'waiting to')((43.4, 43.76), 'unfold Pack')((43.76, 44.3), 'your bags')((44.3, 45.76), 'and let the')((45.76, 46.42), 'journey begin')]
    
    SAMPLE_FILE_NAME = "audio_tts.wav"

    video = get_output_media(SAMPLE_FILE_NAME, timed_captions, timed_generated_image_urls)
    print(video)

